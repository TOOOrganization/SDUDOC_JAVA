(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9a09719c"],{"0480":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[n("v-row",[n("v-col",[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.users.slice((e.currentPage-1)*e.pageSize,e.currentPage*e.pageSize)}},[e._l(e.headers,(function(e){return n("el-table-column",{key:e.label,attrs:{prop:e.prop,label:e.label,fixed:e.fixed,width:e.width,"show-overflow-tooltip":!0}})})),n("el-table-column",{attrs:{label:"operating",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return e.showChangeRole(t.$index,t.row)}}},[e._v("修改角色")]),n("el-button",{staticStyle:{color:"red"},attrs:{size:"mini",type:"text"},on:{click:function(n){return e.showDeleteDialog(t.row)}}},[e._v("删除")])]}}])})],2),n("el-pagination",{attrs:{align:"center","current-page":e.currentPage,"page-size":10,layout:"total, prev, pager, next, jumper",total:e.returnNumber},on:{"current-change":e.handleCurrentChange}})],1)],1),n("v-btn",{staticClass:"mx-2",attrs:{fab:"",dark:"",small:"",color:"primary"},on:{click:function(t){e.addUserDialog=!0}}},[n("v-icon",{attrs:{dark:""}},[e._v(" mdi-plus ")])],1),n("v-dialog",{attrs:{scrollable:"","max-width":"350"},model:{value:e.changeRoleDialog,callback:function(t){e.changeRoleDialog=t},expression:"changeRoleDialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5"},[e._v("修改角色")]),n("v-card-text",{staticStyle:{"margin-top":"10px"}},[n("div",[e._v("用户 "),n("span",{staticStyle:{color:"#3F51B5"}},[e._v(e._s(e.changeRoleItem.user.nickname))]),e._v(" 当前的角色为： "),n("br"),e._l(e.changeRoleItem.role,(function(t){return n("span",{key:t.rid,staticStyle:{color:"red"}},[e._v(" "+e._s(t.role_description)+" "),n("br")])})),e._v(" 修改为："),n("br"),n("v-select",{attrs:{items:e.roleFields,"item-text":"description","item-value":"rid",label:"Select Role","single-line":""},model:{value:e.roleSelect,callback:function(t){e.roleSelect=t},expression:"roleSelect"}})],2)]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.changeRoleDialog=!1}}},[e._v(" Close ")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.setRole}},[e._v(" Save ")])],1)],1)],1),n("v-dialog",{attrs:{persistent:"","max-width":"600px"},model:{value:e.addUserDialog,callback:function(t){e.addUserDialog=t},expression:"addUserDialog"}},[n("v-card",[n("v-card-title",[n("span",{staticClass:"text-h5"},[e._v("User Profile")])]),n("v-card-text",[n("v-container",[n("v-row",[n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:"Username*",required:""},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:"Password*",type:"password",required:""},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1),n("v-col",{attrs:{cols:"12",sm:"6",md:"4"}},[n("v-text-field",{attrs:{label:"ConfirmPassword*",type:"password",hint:"两次输入密码需要相同",required:""},model:{value:e.userForm.confirmPassword,callback:function(t){e.$set(e.userForm,"confirmPassword",t)},expression:"userForm.confirmPassword"}})],1),n("v-col",{attrs:{cols:"12"}},[n("v-text-field",{attrs:{label:"NickName*",required:""},model:{value:e.userForm.nickname,callback:function(t){e.$set(e.userForm,"nickname",t)},expression:"userForm.nickname"}})],1),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-text-field",{attrs:{label:"Email"},model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),n("v-col",{attrs:{cols:"12",sm:"6"}},[n("v-text-field",{attrs:{label:"Phone",required:""},model:{value:e.userForm.phone,callback:function(t){e.$set(e.userForm,"phone",t)},expression:"userForm.phone"}})],1),n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-select",{attrs:{items:e.sex,"item-text":"msg","item-value":"id",label:"Sex"},model:{value:e.userForm.sex,callback:function(t){e.$set(e.userForm,"sex",t)},expression:"userForm.sex"}})],1),n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-select",{attrs:{items:e.year,label:"Year"},on:{change:e.getDay},model:{value:e.Data.year,callback:function(t){e.$set(e.Data,"year",t)},expression:"Data.year"}})],1),n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-select",{attrs:{items:e.month,label:"Month"},on:{change:e.getDay},model:{value:e.Data.month,callback:function(t){e.$set(e.Data,"month",t)},expression:"Data.month"}})],1),n("v-col",{attrs:{cols:"12",sm:"3"}},[n("v-select",{attrs:{items:e.day,label:"Day"},model:{value:e.Data.day,callback:function(t){e.$set(e.Data,"day",t)},expression:"Data.day"}})],1),n("v-col",{attrs:{cols:"12",sm:"7"}},[n("v-select",{attrs:{items:e.roleFields,"item-text":"description","item-value":"rid",label:"Role","single-line":""},model:{value:e.userForm.role,callback:function(t){e.$set(e.userForm,"role",t)},expression:"userForm.role"}})],1)],1)],1),n("small",[e._v("*indicates required field")])],1),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.addUserDialog=!1}}},[e._v(" Close ")]),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:e.addUser}},[e._v(" Save ")])],1)],1)],1),n("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:e.deleteDialog,callback:function(t){e.deleteDialog=t},expression:"deleteDialog"}},[n("v-card",[n("v-card-title",{staticClass:"text-h5"},[e._v(" 删除确认 ")]),n("v-card-text",[e._v("是否要删除用户名为："+e._s(e.deleteItem.username)+" 的用户？")]),n("v-card-actions",[n("v-spacer"),n("v-btn",{attrs:{color:"blue darken-1",text:""},on:{click:function(t){e.deleteDialog=!1}}},[e._v(" Disagree ")]),n("v-btn",{attrs:{color:"red",text:""},on:{click:e.deleteUser}},[e._v(" Agree ")])],1)],1)],1)],1)},i=[],s=n("1da1"),r=(n("96cf"),n("fb6a"),{name:"Ds2UmsUser",data:function(){return{valid:!1,loading:!1,changeRoleDialog:!1,changeRoleItem:{user:{nickname:""}},roleSelect:"",roleFields:[{rid:"",parentRid:"",name:"",description:"",createTime:""}],selectedUid:"",addUserDialog:!1,selectedSex:"",sex:[{id:0,msg:"男"},{id:1,msg:"女"}],year:[],month:[],day:[],Data:{year:"",month:"",day:""},userForm:{username:"",password:"",confirmPassword:"",nickname:"",email:"",phone:"",sex:"",birthday:"",role:""},deleteDialog:!1,deleteItem:"",headers:[{prop:"uid",label:"uid",width:50,fixed:"left"},{prop:"username",label:"username",width:100,fixed:"left"},{prop:"password",label:"password",width:150},{prop:"sex",label:"sex",width:50},{prop:"birthday",label:"birthday",width:150},{prop:"nickname",label:"nickname",width:150},{prop:"email",label:"email",width:200},{prop:"phone",label:"phone",width:120},{prop:"role",label:"role",width:200},{prop:"right",label:"right",width:200}],queryResults:[],users:[],returnNumber:0,numFound:0,currentPage:1,pageSize:10}},mounted:function(){this.submit(),this.getRoles(),this.getYear(),this.getMonth(),this.getDay()},methods:{submit:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.users=[],t.next=4,e.findAll("ds2_user").then((function(t){e.queryResults=t;for(var n=0;n<t.length;n++){switch(e.users.push(t[n].user),t[n].user.sex){case 0:e.users[n].sex="男";break;case 1:e.users[n].sex="女";break}e.users[n].role="";for(var a=0;a<t[n].role.length;a++)null!==t[n].role[a].role_description&&(e.users[n].role+=t[n].role[a].role_description+";");e.users[n].role=e.users[n].role.slice(0,-1),"undefined"===e.users[n].role&&(e.users[n].role=""),e.users[n].right="";for(var i=0;i<t[n].right.length;i++)for(var s=0;s<t[n].right[i].length;s++)null!==t[n].right[i][s].right_description&&(e.users[n].right+=t[n].right[i][s].right_description+";");e.users[n].right=e.users[n].role.slice(0,-1)}e.numFound=t.length,e.returnNumber=t.length}));case 4:e.loading=!1;case 5:case"end":return t.stop()}}),t)})))()},handleCurrentChange:function(e){console.log("当前页: ".concat(e)),this.currentPage=e},showChangeRole:function(e,t){console.log(e),console.log(this.queryResults[e]),this.changeRoleItem=this.queryResults[e],this.selectedUid=t.uid,this.changeRoleDialog=!0},getRoles:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.findAll("ds2_role").then((function(t){console.log(t),e.roleFields=t}));case 2:case"end":return t.stop()}}),t)})))()},setRole:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(e.roleSelect),console.log(e.selectedUid),n=!1,t.next=5,e.updateUserRole(e.selectedUid,e.roleSelect,"ds2").then((function(t){console.log(t),t&&(e.changeRoleDialog=!1,n=!0)}));case 5:if(!n){t.next=10;break}return t.next=8,e.submit();case 8:console.log(e.users),n=!1;case 10:case"end":return t.stop()}}),t)})))()},getYear:function(){for(var e=new Date,t=e.getFullYear(),n=0;n<100;n++){var a=t-n;this.year.push(a)}},getMonth:function(){for(var e=1;e<13;e++)this.month.push(e)},getDay:function(){this.day=[];for(var e=this.getDaysInMonth(this.Data.year,this.Data.month),t=1;t<=e;t++)this.day.push(t)},getDaysInMonth:function(e,t){t=parseInt(t,10);var n=new Date(e,t,0);return n.getDate()},addUser:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return""!==e.Data.year&&""!==e.Data.month&&e.Data.day&&(e.userForm.birthday=e.Data.year+"-"+e.Data.month+"-"+e.Data.day),console.log(e.userForm),t.next=4,e.addOneUser(e.userForm,"ds2").then((function(t){console.log(t),200===t.code?(e.$message({showClose:!0,message:"user添加成功",type:"success"}),e.addUserDialog=!1,e.submit()):500===t.code&&e.$message({showClose:!0,message:t.message,type:"error"})}));case 4:case"end":return t.stop()}}),t)})))()},showDeleteDialog:function(e){this.deleteDialog=!0,this.deleteItem=e},deleteUser:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.deleteOneUser(e.deleteItem.uid,"ds2");case 2:return t.next=4,e.submit();case 4:e.deleteDialog=!1;case 5:case"end":return t.stop()}}),t)})))()}}}),o=r,l=n("2877"),c=n("6544"),u=n.n(c),d=n("8336"),h=n("b0af"),m=n("99d9"),v=n("62ad"),g=n("a523"),f=n("169a"),p=n("132d"),b=n("0fd9"),x=n("b974"),w=n("2fa4"),y=n("8654"),k=Object(l["a"])(o,a,i,!1,null,"2f07df7e",null);t["default"]=k.exports;u()(k,{VBtn:d["a"],VCard:h["a"],VCardActions:m["a"],VCardText:m["b"],VCardTitle:m["c"],VCol:v["a"],VContainer:g["a"],VDialog:f["a"],VIcon:p["a"],VRow:b["a"],VSelect:x["a"],VSpacer:w["a"],VTextField:y["a"]})},"169a":function(e,t,n){"use strict";var a=n("5530"),i=n("2909"),s=n("ade3"),r=(n("a9e3"),n("498a"),n("caad"),n("2532"),n("7db0"),n("368e"),n("480e")),o=n("4ad4"),l=n("b848"),c=n("75eb"),u=n("e707"),d=n("e4d3"),h=n("21be"),m=n("f2e7"),v=n("a293"),g=n("58df"),f=n("d9bd"),p=n("80d2"),b=Object(g["a"])(o["a"],l["a"],c["a"],u["a"],d["a"],h["a"],m["a"]);t["a"]=b.extend({name:"v-dialog",directives:{ClickOutside:v["a"]},props:{dark:Boolean,disabled:Boolean,fullscreen:Boolean,light:Boolean,maxWidth:{type:[String,Number],default:"none"},noClickAnimation:Boolean,origin:{type:String,default:"center center"},persistent:Boolean,retainFocus:{type:Boolean,default:!0},scrollable:Boolean,transition:{type:[String,Boolean],default:"dialog-transition"},width:{type:[String,Number],default:"auto"}},data:function(){return{activatedBy:null,animate:!1,animateTimeout:-1,isActive:!!this.value,stackMinZIndex:200,previousActiveElement:null}},computed:{classes:function(){var e;return e={},Object(s["a"])(e,"v-dialog ".concat(this.contentClass).trim(),!0),Object(s["a"])(e,"v-dialog--active",this.isActive),Object(s["a"])(e,"v-dialog--persistent",this.persistent),Object(s["a"])(e,"v-dialog--fullscreen",this.fullscreen),Object(s["a"])(e,"v-dialog--scrollable",this.scrollable),Object(s["a"])(e,"v-dialog--animated",this.animate),e},contentClasses:function(){return{"v-dialog__content":!0,"v-dialog__content--active":this.isActive}},hasActivator:function(){return Boolean(!!this.$slots.activator||!!this.$scopedSlots.activator)}},watch:{isActive:function(e){var t;e?(this.show(),this.hideScroll()):(this.removeOverlay(),this.unbind(),null==(t=this.previousActiveElement)||t.focus())},fullscreen:function(e){this.isActive&&(e?(this.hideScroll(),this.removeOverlay(!1)):(this.showScroll(),this.genOverlay()))}},created:function(){this.$attrs.hasOwnProperty("full-width")&&Object(f["e"])("full-width",this)},beforeMount:function(){var e=this;this.$nextTick((function(){e.isBooted=e.isActive,e.isActive&&e.show()}))},beforeDestroy:function(){"undefined"!==typeof window&&this.unbind()},methods:{animateClick:function(){var e=this;this.animate=!1,this.$nextTick((function(){e.animate=!0,window.clearTimeout(e.animateTimeout),e.animateTimeout=window.setTimeout((function(){return e.animate=!1}),150)}))},closeConditional:function(e){var t=e.target;return!(this._isDestroyed||!this.isActive||this.$refs.content.contains(t)||this.overlay&&t&&!this.overlay.$el.contains(t))&&this.activeZIndex>=this.getMaxZIndex()},hideScroll:function(){this.fullscreen?document.documentElement.classList.add("overflow-y-hidden"):u["a"].options.methods.hideScroll.call(this)},show:function(){var e=this;!this.fullscreen&&!this.hideOverlay&&this.genOverlay(),this.$nextTick((function(){e.$nextTick((function(){e.previousActiveElement=document.activeElement,e.$refs.content.focus(),e.bind()}))}))},bind:function(){window.addEventListener("focusin",this.onFocusin)},unbind:function(){window.removeEventListener("focusin",this.onFocusin)},onClickOutside:function(e){this.$emit("click:outside",e),this.persistent?this.noClickAnimation||this.animateClick():this.isActive=!1},onKeydown:function(e){if(e.keyCode===p["r"].esc&&!this.getOpenDependents().length)if(this.persistent)this.noClickAnimation||this.animateClick();else{this.isActive=!1;var t=this.getActivator();this.$nextTick((function(){return t&&t.focus()}))}this.$emit("keydown",e)},onFocusin:function(e){if(e&&this.retainFocus){var t=e.target;if(t&&![document,this.$refs.content].includes(t)&&!this.$refs.content.contains(t)&&this.activeZIndex>=this.getMaxZIndex()&&!this.getOpenDependentElements().some((function(e){return e.contains(t)}))){var n=this.$refs.content.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),a=Object(i["a"])(n).find((function(e){return!e.hasAttribute("disabled")}));a&&a.focus()}}},genContent:function(){var e=this;return this.showLazyContent((function(){return[e.$createElement(r["a"],{props:{root:!0,light:e.light,dark:e.dark}},[e.$createElement("div",{class:e.contentClasses,attrs:Object(a["a"])({role:"document",tabindex:e.isActive?0:void 0},e.getScopeIdAttrs()),on:{keydown:e.onKeydown},style:{zIndex:e.activeZIndex},ref:"content"},[e.genTransition()])])]}))},genTransition:function(){var e=this.genInnerContent();return this.transition?this.$createElement("transition",{props:{name:this.transition,origin:this.origin,appear:!0}},[e]):e},genInnerContent:function(){var e={class:this.classes,ref:"dialog",directives:[{name:"click-outside",value:{handler:this.onClickOutside,closeConditional:this.closeConditional,include:this.getOpenDependentElements}},{name:"show",value:this.isActive}],style:{transformOrigin:this.origin}};return this.fullscreen||(e.style=Object(a["a"])(Object(a["a"])({},e.style),{},{maxWidth:"none"===this.maxWidth?void 0:Object(p["f"])(this.maxWidth),width:"auto"===this.width?void 0:Object(p["f"])(this.width)})),this.$createElement("div",e,this.getContentSlot())}},render:function(e){return e("div",{staticClass:"v-dialog__container",class:{"v-dialog__container--attached":""===this.attach||!0===this.attach||"attach"===this.attach},attrs:{role:"dialog"}},[this.genActivator(),this.genContent()])}})},"368e":function(e,t,n){},"99d9":function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l}));var a=n("b0af"),i=n("80d2"),s=Object(i["g"])("v-card__actions"),r=Object(i["g"])("v-card__subtitle"),o=Object(i["g"])("v-card__text"),l=Object(i["g"])("v-card__title");a["a"]}}]);
//# sourceMappingURL=chunk-9a09719c.a2b1d8b9.js.map